# Deep Isolation Forest 异常检测算法

## 项目概述

Deep Isolation Forest（深度隔离森林）是一种先进的异常检测算法，通过将深度神经网络与传统隔离森林算法结合，有效解决了高维数据、非线性分布场景下的异常检测难题。该算法利用随机初始化神经网络将原始数据映射到新的特征空间，通过轴平行分割实现高效的异常点隔离，在表格数据、图形数据和时间序列数据上均展现出优于传统隔离算法的检测性能。

## 算法原理

### 3.1 机器学习视角分析

#### 学习任务
- 核心任务：异常检测（可视为特殊的二分类问题，区分正常/异常数据点）
- 与传统任务区别：无需预定义类别标签，依赖数据分布特性

#### 学习范式
- **无监督学习**：仅利用数据自身特征分布进行异常判断，无需标注数据
- **集成学习**：通过多棵深度隔离树的集成结果提升检测鲁棒性和准确性

#### 学习框架
- 基于**联结主义框架**：利用神经网络构建数据的非线性表示空间，突破传统线性分割限制

### 3.2 算法核心机制

#### 传统Isolation Forest的局限性
- 当异常点被环形正态样本包围时（如图4），无法通过简单轴平行切割实现有效隔离，导致高假阴性错误

#### Deep Isolation Forest的创新设计
1. **深度表示集成（CERE）**  
   通过随机初始化的神经网络将原始数据映射到多维随机表示空间，使非线性隔离在新空间中转化为线性分割问题。

2. **深度隔离树构建流程**  
   - **子采样初始化**：对转换后的数据进行随机子采样，生成根节点
   - **迭代分割策略**：每次从所有维度中随机选择一个维度`jk`和分割点`ηk`，将节点数据按`x(jk) ≤ ηk`和`x(jk) > ηk`划分为左右子节点
   - **停止条件**：节点数据量≤1 或树深度达到预设最大值J

3. **异常分数计算模型**  
   - **累积差异β**：遍历路径中特征值与分割阈值的偏差绝对值之和  
     `β = ∑|x_u(jk) - ηk|`（k为路径上的节点）
   - **平均偏差度g**：累积差异与路径长度的比值  
     `g(x_u|τi) = β / |p(x_u|τi)|`
   - **最终异常分数**：  
     `ℱ_DEAS(o|T) = 2^(-E[|p(x_u|τi)|/C(T)]) × E[g(x_u|τi)]`  
     （其中E为集成期望，C(T)为树的平均路径长度）

## 实验验证

### 3.3.1 数据集说明
| 数据集     | 样本数N | 特征维度D | 异常样本数(比例)   |
|------------|---------|-----------|--------------------|
| Pageblocks | 5393    | 11        | 510 (9.46%)        |
| Shuttle    | 1013    | 10        | 13 (1.28%)         |

### 3.3.2 关键参数设置
- 随机表示数量：r = 50  
- 每表示隔离树数量：t = 6  
- 子采样大小：n = 256  
- 网络结构：全连接多层感知器（适用于表格数据）

### 3.3.3 性能指标对比
| 数据集     | AUC-ROC   | AUC-PR    | 检测时间(s) |
|------------|-----------|-----------|-------------|
| Pageblocks | 0.8980    | 0.5454    | 0.7         |
| Shuttle    | 0.9479    | 0.1893    | 0.4         |

## 算法优势

1. **非线性隔离能力**  
   通过神经网络映射，有效解决传统隔离森林在环形、复杂分布数据中的检测瓶颈

2. **高维数据适应性**  
   随机表示集成策略降低高维空间中的"维度灾难"影响，提升检测稳定性

3. **计算效率平衡**  
   子采样机制与树结构优化确保大规模数据下的实时检测能力

## 应用场景

- **网络安全**：实时入侵检测、恶意流量识别  
- **金融风控**：欺诈交易监测、异常资金流分析  
- **工业监控**：设备故障预警、传感器数据异常识别  
- **医疗健康**：生理指标异常检测、罕见病例辅助诊断  

## 未来优化方向

1. **评分策略精细化**  
   探索数据表示与异常评分的深度融合，提升复杂场景下的检测精度

2. **多模态数据扩展**  
   优化模型结构以适应图像、文本、音频等非结构化数据的异常检测需求

3. **增量学习集成**  
   结合增量学习范式，实现动态数据流环境下的持续异常检测与模型更新
